@using BudgetManager.Models.Report
@model ReportViewModel
@{
	ViewData["Title"] = "Reportes";
}

<h1 class="mb-3">Reportes</h1>


<div class="report-container">
	<div class="tabs mb-3">
		<button type="button" class="tab-button" data-target="monthly" aria-pressed="false">Mensual</button>
		<button type="button" class="tab-button" data-target="range" aria-pressed="false">Rango</button>
		<button type="button" class="tab-button" data-target="category" aria-pressed="false">Categoría</button>
	</div>

	<div id="monthly" 
		class="tab-panel"
		style="display:@(Model.ReportType == "monthly" ? "block" : "none")">
		<partial name="_Monthly" model="Model" />
	</div>
	<div id="range" 
		class="tab-panel"
			 style="display: @(Model.ReportType == "range" ? "block" : "none")">
		<partial name="_Range" model="Model" />
	</div>
	<div id="category" 
		class="tab-panel" 
		style="display: @(Model.ReportType == "category" ? "block" : "none")">
		<partial name="_Category" model="Model" />
	</div>
</div>

@section Scripts{
	<script>
			document.addEventListener('DOMContentLoaded', function () {
			const buttons = document.querySelectorAll('.tab-button');
			const panels = document.querySelectorAll('.tab-panel');
			
			function setActive(target) {
				panels.forEach(p => p.style.display = (p.id === target ? 'block' : 'none'));

				buttons.forEach(b => {
					const isActive = b.getAttribute('data-target') === target;
					b.classList.toggle('active', isActive);
					b.setAttribute('aria-pressed', isActive ? 'true' : 'false');
				});

				document.querySelectorAll('form').forEach(form => {
					const input = form.querySelector('input[name="ReportType"]');
					if (input) input.value = target;
				});
			}

			const initial = '@(Model.ReportType ?? "monthly")';
			setActive(initial);

			buttons.forEach(btn => {
				btn.addEventListener('click', () => {
					const target = btn.getAttribute('data-target');
					setActive(target);
				});
			});
		});
	</script>
}